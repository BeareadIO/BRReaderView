//
//  ViewController.swift
//  BRReaderView
//
//  Created by Archy on 2018/9/14.
//  Copyright © 2018 Archy. All rights reserved.
//

import UIKit

class ViewController: UIViewController {

    @IBOutlet weak var textView: BRReaderView!
    
    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib.
        let test = "<p sort=\"1\">华筝刚摘掉眼镜就听见耳边响起了一声做作的咳嗽。</p><p sort=\"2\"><pic>https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1538126439914&di=7d4dade745050f5cf9ef0a3f240c85f1&imgtype=0&src=http%3A%2F%2Fg.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2F024f78f0f736afc3df9f4547b019ebc4b7451204.jpg</pic></p><p sort=\"3\">迈文也没打算装，厚颜无耻的抬起手，动了动手指：“嗨~”</p><p sort=\"4\">华筝没什么表情，他似乎早料到对方会来，招呼都懒得招呼，伸手随意指了指旁边的坐位，示意迈文坐过去。</p><p sort=\"5\">迈文无语：“你又看不见，管我坐着还是站着。”</p><p sort=\"6\">华筝冷淡道：“你站着耗氧。”</p><p sort=\"7\">迈文：“……”神他妈耗氧！好好活着不好嘛？！</p><p sort=\"8\"><br></p><p sort=\"9\">杨力今天给华筝梳的是盘发，这种千年前流行的发式，现如今只有妈奶级别的beta才会偶尔尝试，奈何华筝真是天妒人怨的神颜，任何发型都只能衬托出他更加完美的脸。</p><p sort=\"10\">身为母A的迈文实在是羡慕嫉妒恨，以至于说话都有些酸溜溜的：“你和小巧克力怎么回事，八字还没一撇呢，就先公布了？”</p><p sort=\"11\">华筝不说话，他向来不喜欢解释自己做了什么或者想做什么，所以在不死单身狗烧烧烧联盟里他也是最独的那个。</p><p sort=\"12\">迈文搔了搔头，他算是知道一些华筝眼盲的前因后果，只是这向来是对方禁区，谁也不能提,这么多年过去了，用陈女士的话说，完全没想到多年后居然还有机会再把人找回来。</p><p sort=\"13\"></p><p sort=\"14\">其实外界说他们7个alpha注定孤独终老既是玩笑话也不是玩笑话，因为相比于普通alpha，他们的发情期还要再提早五年，而在初次发情期中遇到的omega，哪怕没有任何实质性接触，也是情定终身、一见钟情的存在。</p><p sort=\"15\">——至此就有很多非常不确定的问题出现了。</p><p sort=\"16\">首先对方是否可以承受住顶尖alpha的情潮。</p><p sort=\"17\">其次，对方如果当时不在发情期内，那么顶尖alpha的第一次剧烈发情该如何处理。</p><p sort=\"18\">最后——哪怕前面两个都能避免掉，再要等omega真正成熟的第一次特殊发情期间，对方如果有了别的意中人的话……那他们这群特殊的alpha就真的只能承受孤独终老的苦果了。</p><p sort=\"19\">虽然华筝没有详细说过当时他与杨力的情况，但迈文这群人用脚趾头都能猜到应该是遇到了最糟糕的那种，否则华筝也不会付出双眼被毁的代价。</p><p sort=\"20\"></p><p sort=\"21\">“你当时就应该狠狠心，直接做到最后。”迈文是很典型的站着说话不腰疼的性格，他也不怎么会看华筝的脸色。</p><p sort=\"22\">华筝终于纡尊降贵的开了口：“他那年22岁都没到。”</p><p sort=\"23\">迈文：“……”自从公元3000年后，omega的成年期是25周岁，在此之前都是未成年，强行发生性关系的话是要吃官司的。</p><p sort=\"24\">“你老实回答我。”迈文突然严肃了神情，眯着眼质问道，“你到底还是不是处男了？”</p><p sort=\"25\"></p><p sort=\"26\">杨力托着空盘子回到厨房的时候才从厨娘的口中知道来了客人。</p><p sort=\"27\">“迈文先生？”杨力有些惊讶，他当然知道这位时尚界首屈一指的顶尖alpha，包括其著名的比大部分O还要母的花孔雀个性。</p><p sort=\"28\">厨娘笑着道：“他可是老爷难得的朋友。”</p><p sort=\"29\">杨力有些无法想象这南辕北辙的两个人居然还是朋友……</p><p sort=\"30\">他在走廊中遇到了陈女士。</p><p sort=\"31\">于是杨力主动道：“我需要多准备一个人的晚餐吗？”</p><p sort=\"32\">“多准备？”陈女士莫名其妙，“给谁？”</p><p sort=\"33\">杨力：“迈文先生不是来了么？”</p><p sort=\"34\">陈女士惶然：“哦，你说他啊。”</p><p sort=\"35\">“不需要。”她摆了摆手，像驱赶苍蝇一般，“老爷不会留他吃饭的，容易倒胃口。”</p><p sort=\"36\">杨力：“……”说好的朋友呢？！</p><p sort=\"37\">“而且……”陈女士的目光落在了杨力的脸上。</p><p sort=\"38\">英俊的管家下意识露出笑容，脸上带着得体的询问。</p><p sort=\"39\">陈女士不得不在内心深处感慨，这人真的比巧克力还甜美，怪不得让人念念不忘了……</p><p sort=\"40\">“而且老爷也不会同意让你服侍其他人。”陈女士伸出手拍了拍杨力的肩膀，表情说不上是复杂多点还是无奈多点。</p><p sort=\"41\">杨力满脸问号，但还是尽责道：“所以，您的意思是……”</p><p sort=\"42\">陈女士深吸一口气，语气严肃又认真：“所以请无论如何，全身心的奉献给他吧。”</p><p sort=\"43\"></p><p sort=\"44\"><br></p>"
        
        textView.frame.size.width = UIScreen.main.bounds.width - 30
        textView.parser = ReaderParser.shared
        textView.readerViewDelegate = self
        textView.formattedString = test
    }

}

extension ViewController: ReaderViewDelegate {
    
    func readerView(_ readerView: ReaderView, viewForItem item: ReaderItem, at range: NSRange) -> UIView {
        if item.type == .image, let imageItem = item.data as? ReaderImage {
            let componentNib = UINib(nibName: String(describing: ReaderImageComponentView.self), bundle: nil)
            let componentView = componentNib.instantiate(withOwner: nil, options: nil).first as! ReaderImageComponentView
            componentView.data = imageItem
            return componentView
        }
        return UIView()
    }
    
}

